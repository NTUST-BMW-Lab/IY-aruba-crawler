<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RSSIIY-Doxygen: Process and store data in Data Center&#39;s MongoDB</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">RSSIIY-Doxygen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Process and store data in Data Center's MongoDB</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md10"></a></p>
<h1><a class="anchor" id="autotoc_md11"></a>
Feature</h1>
<p>To retrieve, process, and store WiFi data in MongoDB databases server in NTUST Data Center</p>
<h1><a class="anchor" id="autotoc_md12"></a>
Requirement</h1>
<ul>
<li>MongoDB &gt; 3.4.x </li>
</ul>
<h1><a class="anchor" id="autotoc_md13"></a>
Directory</h1>
<div class="fragment"><div class="line">RSSIIY</div>
<div class="line">|__ src</div>
<div class="line">|  |__ Controller4 # Crawling AP, User, and Radio data source code</div>
<div class="line">|  |__ Positioning # Indoor Positioning source code</div>
<div class="line">|__ data # Leave it blank</div>
<div class="line">|__ docs</div>
<div class="line">|  |__ (pydocs files)</div>
<div class="line">|  |__ databases.png</div>
<div class="line">|  |__ system_architecture.png</div>
<div class="line">|  |__ dashboard_development.md</div>
<div class="line">|__ test</div>
<div class="line">|  |__ Controller4_ipynb # Controller4 test results on Jupiter Notebook</div>
<div class="line">|  |__ Positioning_ipynb # Indoor positioning test results on Jupiter Notebook</div>
<div class="line">|__ EdgeSDK_Client_Number.py # Connect client number to WISE-PaaS DataHub</div>
<div class="line">|__ EdgeSDK_AP_Coordinate.py # Connect interfering/rogue APs coordinate axis (x, y) to WISE-PaaS DataHub</div>
<div class="line">|__ Trilateration.py # Trilateration alrogithm</div>
<div class="line">|__ Trilaterationipynb # Trilateration test results on Jupiter Notebook</div>
<div class="line">|__ README.md</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md14"></a>
A. Access to Data Center's MongoDB databases server</h1>
<h2><a class="anchor" id="autotoc_md15"></a>
Access to Data Center Window server</h2>
<ul>
<li>From Window, choose Remote Desktop Connection</li>
<li>Enter Data Center IP address, username and password to connect to the server (Contact Victor to get the IP address, username and password). <img src="https://github.com/nguyennam2010/RSSIIY/assets/102983698/d2fd531e-75cf-47fd-8805-14296482c35c" alt="1" class="inline"/></li>
</ul>
<h2><a class="anchor" id="autotoc_md16"></a>
Connect to MongoDB databases server</h2>
<ul>
<li>To turn on auth server, open cmd and cd to <div class="fragment"><div class="line">cd C:\Program Files\MongoDB\Server\3.6\bin</div>
</div><!-- fragment --></li>
<li>Enter: <div class="fragment"><div class="line">mongod --bind_ip_all</div>
</div><!-- fragment --> to listen to outside ip</li>
</ul>
<p><img src="https://github.com/nguyennam2010/RSSIIY/assets/102983698/3e1ce288-c899-4d2f-b9dd-15753de21dad" alt="2" class="inline"/></p>
<ul>
<li>Open Robo3T. We can now connect to MongoDB databases server</li>
</ul>
<p><img src="https://github.com/nguyennam2010/RSSIIY/assets/102983698/0a9e6479-1e0c-4a64-bbd7-787715963edf" alt="3" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md17"></a>
B. Run script</h1>
<ul>
<li>Download config (.env) file and xlsx file from Google Drive</li>
<li>Put them in the same directory with Controller4 and Positioning</li>
<li>Open Spyder and run these 4 python scripts:<ul>
<li>Run <code><a class="el" href="src_2_controller4_2main_8py.html">Controller4/main.py</a></code> to retrieve and store AP, User, Radio data to MongoDB</li>
<li>Run <code><a class="el" href="src_2_positioning_2main_8py.html">Positioning/main.py</a></code> for indoor positioning</li>
<li>Run <code><a class="el" href="_edge_s_d_k___a_p___coordinate_8py.html">EdgeSDK_AP_Coordinate.py</a></code> to connect interfering/rogue APs coordinate axis (x, y) to WISE-PaaS DataHub, in order to show rogue APs (x, y) axis to Dashboard</li>
<li>Run <code><a class="el" href="_edge_s_d_k___client___number_8py.html">EdgeSDK_Client_Number.py</a></code> to connect client number to WISE-PaaS DataHub, in order to show the number of clients in Dashboard.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md18"></a>
C. Query data from databases to WISE-PaaS</h1>
<h2><a class="anchor" id="autotoc_md19"></a>
Add MongoDB data source to Dashboard</h2>
<ul>
<li>Open Dashboard -&gt; Setting -&gt; Data Source -&gt; Add data source</li>
<li>Choose MongoDB and enter:<ul>
<li>Datasource Name (ex： Aruba_AP)</li>
<li>Enable TLS</li>
<li>API URL. We use GPU Server from BMW lab (ex: <a href="http://GPUSERVERIP:3333">http://GPUSERVERIP:3333</a>).<ul>
<li>Info of our lab Server: <a href="https://hackmd.io/@jackychiang/SkZ-z-dU5">https://hackmd.io/@jackychiang/SkZ-z-dU5</a></li>
</ul>
</li>
<li>VM MongoDB URL （ex: mongodb://administrator:administrator@MONGOIP:27017)</li>
<li>MongoDB Database (ex: WiFi_AP_Data)</li>
</ul>
</li>
</ul>
<p><img src="https://github.com/nguyennam2010/RSSIIY/assets/102983698/f4cd6f4f-1f79-42cd-91cf-e16de26148e5" alt="4" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md20"></a>
Display aruba AP data into Dashboard</h2>
<ul>
<li>Create new dashboard, query to desired data source (ex: Aruba_AP)</li>
<li>Insert appropriate aggregation. For example, we want to query AP data from WiFi_AP_Data:</li>
</ul>
<div class="fragment"><div class="line">db.Controller_4.aggregate([</div>
<div class="line">{&quot;$sort&quot;:{&quot;ts&quot;:-1, &quot;Client&quot;:-1}},</div>
<div class="line">{&quot;$match&quot;: { &quot;ts&quot;:{ &quot;$gte&quot; : &quot;$from&quot;}}}, </div>
<div class="line">{&quot;$project&quot;: {&quot;AP Name&quot;:&quot;$AP Name&quot;, &quot;value&quot;:&quot;$Client&quot;,&quot;ts&quot;:&quot;$ts&quot;}},</div>
<div class="line">{&quot;$limit&quot;:48}</div>
<div class="line">            ])</div>
</div><!-- fragment --><ul>
<li>The result shows the AP and their client numbers: <img src="https://github.com/nguyennam2010/RSSIIY/assets/102983698/3de019e1-b311-4947-a3d6-0f30d90eaf58" alt="5" class="inline"/></li>
</ul>
<h2><a class="anchor" id="autotoc_md21"></a>
Run mongodb-grafana API on background</h2>
<ol type="1">
<li>Install foreverjs package (only install once) npm install forever -g</li>
<li>Go the the directory <div class="fragment"><div class="line">cd Desktop/mongodb-grafana/dist/server</div>
</div><!-- fragment --></li>
<li>Run API in background <div class="fragment"><div class="line">forever start mongodb-proxy.js</div>
</div><!-- fragment --></li>
<li>Check API is running <div class="fragment"><div class="line">forever list</div>
</div><!-- fragment --></li>
<li>Check API from browser</li>
</ol>
<ul>
<li><a href="http://you.ip.address.here:3333/">http://you.ip.address.here:3333/</a></li>
<li>If successful it will shows: <div class="fragment"><div class="line">{&quot;message&quot;:&quot;Cannot read properties of undefined (reading &#39;url&#39;)&quot;}</div>
</div><!-- fragment --> Sometimes, if GPU server shuts down due to power cutoff, you need to rerun the API. In this case, you only need to do the step from 2 to 5.</li>
</ul>
<h1><a class="anchor" id="autotoc_md22"></a>
D. Demo video</h1>
<p><a href="https://youtu.be/wY7TLPMICaM">https://youtu.be/wY7TLPMICaM</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
